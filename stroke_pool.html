<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Stroke Pool</title><link rel="stylesheet" href="style/stroke_pool.css"></head><body><div id="stroke_pool"></div><h1>Stroke Pool</h1><pre>Instructions:
    Click Ball to pocket for selected player.
    Click Player to set selected player.</pre></body><script>/**
 * COMMON UTILITIES
 */

function create(tagName, attributeList) {

    var element = document.createElement(tagName);

    var attributeList = attributeList ? attributeList : {};

    for (var i = 0, keys = Object.keys(attributeList); keys.length; i++) {
        var key = keys[i];
        var value = attributeList[key];
        element.setAttribute(key, value);
    }

    return element;
}


function div() {
    return document.createElement('div');
}

function get(id) {
    return document.getElementById(id);
}

function defer(f) {
    document.addEventListener('DOMContentLoaded', f);
}

function append(element){
    document.body.appendChild(element);
}function createNS(URI, tagName) {
    var element = document.createElementNS(URI, tagName);

    var list = attributeList ? attributeList : {};

    for (var i = 0, keys = Object.keys(attributeList); keys.length; i++) {
        var key = keys[i];
        var value = attributeList[key];
        element.setAttributeNS(URI, key, value);
    }

    return element;
}

function createSVG(tagName) {
    return createNS('http://www.w3.org/2000/svg', tagName)
}

function svg(width, height, viewPort) {
    var element = create('svg', {
        'width': width !== undefined ? width : 120,
        'height': height !== undefined ? height : 120,
        'viewPort': viewPort !== undefined ? viewPort : '0 0 120 120',
        'version': '1.1',
        'xmlns': "http://www.w3.org/2000/svg"
    });
    return element;
}

function circle(center_x, center_y, radius) {
    return createSVG('circle', {
        'cx': center_x,
        'cy': center_y,
        'r': radius
    });
}

//
// <?xml version="1.0" encoding="utf-8"?>
// <svg width="120" height="120" viewPort="0 0 120 120" version="1.1" xmlns=>
//     <circle cx="60" cy="60" r="50"/>
//     </svg>


/**
 * BALL
 */

function Ball(ordinal) {
    this.ordinal = ordinal;
}

Ball.prototype.toString = function () {
    var i = this.ordinal;
    return i < 9 ? '( ' + i + ' )' : '(/' + i + '/)';
};



/**
 * BALL CONTAINER
 */

function BallContainer(quantity) {
    this.ballList = [];

    for (var i = 1; i <= quantity; i++) {
        this.addBall(
            new Ball(i)
        );
    }
}

BallContainer.prototype.addBall = function (ball) {
    return this.ballList.push(ball);
};

BallContainer.prototype.removeBall = function (ball) {
    var i = this.ballList.indexOf(ball);
    var removedBall = this.ballList.splice(i, 1)[0];

    return removedBall;
};

BallContainer.prototype.getValue = function () {
    var value = 0;
    for (var i = 0; i < this.ballList.length; i++) {
        value += this.ballList[i].ordinal;
    }
    return value;
};

BallContainer.prototype.onBallClick = function (e) {
    console.log('Clicked: ' + e.model.toString())
};

BallContainer.prototype.drawBall = function (b) {

    var e = div();

    e.innerHTML = b.toString();
    e.classList.add('ball');

    e.ballOwner = this;

    e.addEventListener('click', this.onBallClick);

    b.element = e;
    e.model = b;

    return e;
};

BallContainer.prototype.drawBallList = function () {

    var e = div();

    for (var i = 0; i < this.ballList.length; i++) {

        e.appendChild(
            this.drawBall(this.ballList[i])
        );

    }

    return e;

};/**
 * PLAYER
 */

function Player(name) {
    this.name = name;
    BallContainer.call(this, 0);
}
Player.prototype = Object.create(BallContainer.prototype);


Player.prototype.toString = function () {
    return 'Name: ' + this.name + '<br>Score: ' + this.getValue() + '<br>';
};

/**
 * POOL TABLE
 * @constructor
 */

function PoolTable(ballQuantity) {
    BallContainer.call(this, ballQuantity);
}
PoolTable.prototype = Object.create(BallContainer.prototype);
/**
 * THE STROKE POOL GAME
 */

function StrokePool(target, options) {

    var defaultOptions = {
        MAX_BALLS: 15,
        DEFAULT_PLAYERS: 2
    };
    this.options = options ? options : defaultOptions;

    this.target = target;
    this.players = [];

    this.setup();
    this.setupInterface();
    this.draw();

}

StrokePool.prototype.setupInterface = function () {
    this.ballList = div();
    this.playerList = div();
    this.target.appendChild(this.ballList);
    this.target.appendChild(this.playerList);

    var that = this;

    this.table.onBallClick = function (e) {
        var removedBall = that.table.removeBall(e.target.model);
        that.currentPlayer.addBall(removedBall);
        that.draw();
    };

};

StrokePool.prototype.setup = function () {

    this.table = new PoolTable(15);

    for (var p = 1; p <= this.options.DEFAULT_PLAYERS; p++) {
        this.players.push(new Player('Player ' + p));
    }

    this.currentPlayer = this.players[0];

};


StrokePool.prototype.drawPlayer = function (p) {
    var e = create('div');
    e.innerHTML = p.toString();

    e.classList.add('player');

    if (this.currentPlayer === p) {
        e.classList.add('selected');
    }

    var that = this;

    e.addEventListener('click', function (e) {
        if (!e.target.classList.contains('player')) {
            return;
        }

        that.currentPlayer.element.classList.remove('selected');
        e.target.classList.add('selected');
        that.currentPlayer = e.target.model;

    });

    e.appendChild(p.drawBallList());

    e.model = p;
    p.element = e;

    return e;
};

StrokePool.prototype.drawPlayers = function () {

    for (var i = 0; i < this.players.length; i++) {
        var e = this.drawPlayer(this.players[i]);
        this.target.appendChild(e);

        var that = this;

        this.players[i].onBallClick = function (e) {
            var removedBall = e.target.ballOwner.removeBall(e.target.model);
            that.table.addBall(removedBall);
            that.draw();
        };

    }

};

StrokePool.prototype.draw = function () {

    this.target.innerHTML = '';

    this.target.appendChild(this.table.drawBallList());
    this.drawPlayers();
};/**
 * CREATE GAME INSTANCE
 */
defer(function () {
    // var s = svg();
    // var c = circle();
    // append(s);
    new StrokePool(
        get('stroke_pool')
    );
});

</script></html>